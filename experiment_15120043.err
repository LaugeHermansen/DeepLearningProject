Loaded dependency [numpy/1.23.3-python-3.10.7-openblas-0.3.21]: openblas/0.3.21
Loaded dependency [python3/3.10.7]: gcc/11.3.0-binutils-2.38
Loaded dependency [numpy/1.23.3-python-3.10.7-openblas-0.3.21]: python3/3.10.7
Loaded dependency [pandas/1.4.4-python-3.10.7]: numpy/1.23.3-python-3.10.7-openblas-0.3.21
Loaded module: pandas/1.4.4-python-3.10.7

Loading pandas/1.4.4-python-3.10.7
  Loading requirement: openblas/0.3.21 gcc/11.3.0-binutils-2.38 python3/3.10.7
    numpy/1.23.3-python-3.10.7-openblas-0.3.21
Loaded module: matplotlib/3.6.0-numpy-1.23.3-python-3.10.7
Loaded module: cuda/11.6
Global seed set to 42
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:   0%|          | 0/2545 [00:00<?, ?it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  18%|█▊        | 458/2545 [00:00<00:00, 4563.33it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  36%|███▌      | 922/2545 [00:00<00:00, 4605.96it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  55%|█████▍    | 1394/2545 [00:00<00:00, 4655.83it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  73%|███████▎  | 1868/2545 [00:00<00:00, 4686.69it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  92%|█████████▏| 2337/2545 [00:00<00:00, 4681.61it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train: 100%|██████████| 2545/2545 [00:00<00:00, 4642.28it/s]
Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:   0%|          | 0/22909 [00:00<?, ?it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:   2%|▏         | 533/22909 [00:00<00:04, 5327.01it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:   5%|▍         | 1066/22909 [00:00<00:04, 5306.84it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:   7%|▋         | 1600/22909 [00:00<00:04, 5320.22it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:   9%|▉         | 2133/22909 [00:00<00:03, 5302.41it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  12%|█▏        | 2674/22909 [00:00<00:03, 5338.61it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  14%|█▍        | 3208/22909 [00:00<00:03, 5225.49it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  16%|█▋        | 3731/22909 [00:00<00:04, 3896.52it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  18%|█▊        | 4166/22909 [00:00<00:05, 3526.69it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  20%|█▉        | 4553/22909 [00:01<00:05, 3206.10it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  21%|██▏       | 4899/22909 [00:01<00:05, 3070.81it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  23%|██▎       | 5222/22909 [00:01<00:05, 2984.35it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  24%|██▍       | 5531/22909 [00:01<00:05, 2900.09it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  25%|██▌       | 5827/22909 [00:01<00:06, 2844.16it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  28%|██▊       | 6308/22909 [00:01<00:04, 3357.83it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  30%|██▉       | 6838/22909 [00:01<00:04, 3884.54it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  32%|███▏      | 7360/22909 [00:01<00:03, 4257.80it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  34%|███▍      | 7875/22909 [00:01<00:03, 4510.85it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  36%|███▋      | 8336/22909 [00:02<00:03, 4111.69it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  38%|███▊      | 8761/22909 [00:02<00:03, 3615.75it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  40%|███▉      | 9141/22909 [00:02<00:04, 3355.61it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  41%|████▏     | 9491/22909 [00:02<00:04, 3121.10it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  43%|████▎     | 9814/22909 [00:02<00:04, 2981.90it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  44%|████▍     | 10119/22909 [00:02<00:04, 2894.60it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  45%|████▌     | 10413/22909 [00:02<00:04, 2807.93it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  47%|████▋     | 10696/22909 [00:03<00:04, 2742.56it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  48%|████▊     | 10972/22909 [00:03<00:04, 2728.18it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  49%|████▉     | 11252/22909 [00:03<00:04, 2746.74it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  50%|█████     | 11528/22909 [00:03<00:04, 2715.67it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  52%|█████▏    | 11816/22909 [00:03<00:04, 2761.83it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  53%|█████▎    | 12093/22909 [00:03<00:03, 2756.08it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  54%|█████▍    | 12369/22909 [00:03<00:03, 2737.15it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  55%|█████▌    | 12643/22909 [00:03<00:03, 2693.67it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  56%|█████▋    | 12913/22909 [00:03<00:03, 2652.58it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  58%|█████▊    | 13187/22909 [00:03<00:03, 2676.13it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  59%|█████▊    | 13455/22909 [00:04<00:03, 2660.54it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  61%|██████    | 13927/22909 [00:04<00:02, 3264.53it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  62%|██████▏   | 14275/22909 [00:04<00:02, 3326.51it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  64%|██████▍   | 14609/22909 [00:04<00:02, 3135.39it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  65%|██████▌   | 14926/22909 [00:04<00:02, 2950.90it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  66%|██████▋   | 15225/22909 [00:04<00:02, 2833.17it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  68%|██████▊   | 15512/22909 [00:04<00:02, 2770.63it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  69%|██████▉   | 15791/22909 [00:04<00:02, 2701.29it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  70%|███████   | 16063/22909 [00:04<00:02, 2683.91it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  71%|███████▏  | 16333/22909 [00:05<00:02, 2662.74it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  72%|███████▏  | 16606/22909 [00:05<00:02, 2679.11it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  74%|███████▎  | 16875/22909 [00:05<00:02, 2661.09it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  75%|███████▍  | 17168/22909 [00:05<00:02, 2737.42it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  76%|███████▌  | 17443/22909 [00:05<00:02, 2721.78it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  77%|███████▋  | 17716/22909 [00:05<00:01, 2715.04it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  79%|███████▊  | 17988/22909 [00:05<00:01, 2701.75it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  80%|███████▉  | 18285/22909 [00:05<00:01, 2779.13it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  81%|████████  | 18565/22909 [00:05<00:01, 2782.37it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  82%|████████▏ | 18844/22909 [00:05<00:01, 2711.24it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  83%|████████▎ | 19116/22909 [00:06<00:01, 2674.24it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  85%|████████▍ | 19384/22909 [00:06<00:01, 2612.66it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  86%|████████▌ | 19662/22909 [00:06<00:01, 2658.32it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  87%|████████▋ | 19942/22909 [00:06<00:01, 2699.59it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  88%|████████▊ | 20218/22909 [00:06<00:00, 2715.48it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  89%|████████▉ | 20490/22909 [00:06<00:00, 2695.50it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  91%|█████████ | 20760/22909 [00:06<00:00, 2691.40it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  92%|█████████▏| 21030/22909 [00:06<00:00, 2632.59it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  93%|█████████▎| 21294/22909 [00:06<00:00, 2623.70it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  94%|█████████▍| 21557/22909 [00:06<00:00, 2618.63it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  95%|█████████▌| 21820/22909 [00:07<00:00, 2567.84it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  96%|█████████▋| 22079/22909 [00:07<00:00, 2573.37it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  98%|█████████▊| 22362/22909 [00:07<00:00, 2646.97it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train:  99%|█████████▉| 22646/22909 [00:07<00:00, 2703.63it/s]Preprocessing /dtu/blackhole/11/155505/NST_dataset/dataset/train: 100%|██████████| 22909/22909 [00:07<00:00, 3065.35it/s]
/zhome/56/e/155505/Desktop/DeepLearningProject/diffwave/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:604: UserWarning: Checkpoint directory /zhome/56/e/155505/Desktop/DeepLearningProject/experiments/from_bottom_v3_42 exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
Restoring states from the checkpoint path at experiments/from_bottom_v3_42/time-epoch=183-val_loss=0.041604.ckpt
/zhome/56/e/155505/Desktop/DeepLearningProject/diffwave/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py:1438: UserWarning: Be aware that when using `ckpt_path`, callbacks used to create the checkpoint need to be provided during `Trainer` instantiation. Please add the following callbacks: ["ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 0, 'train_time_interval': datetime.timedelta(seconds=3600), 'save_on_train_epoch_end': True}"].
  rank_zero_warn(
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name                  | Type                 | Params
---------------------------------------------------------------
0 | diffusion_embedding   | DiffusionEmbedding   | 328 K 
1 | spectrogram_upsampler | SpectrogramUpsampler | 194   
2 | residual_layers       | ModuleList           | 2.3 M 
3 | input_projection      | Conv1d               | 128   
4 | skip_projection       | Conv1d               | 4.2 K 
5 | output_projection     | Conv1d               | 65    
6 | loss_fn               | L1Loss               | 0     
---------------------------------------------------------------
2.6 M     Trainable params
0         Non-trainable params
2.6 M     Total params
10.480    Total estimated model params size (MB)
Restored all states from the checkpoint file at experiments/from_bottom_v3_42/time-epoch=183-val_loss=0.041604.ckpt
/zhome/56/e/155505/Desktop/DeepLearningProject/diffwave/lib/python3.10/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py:143: UserWarning: You're resuming from a checkpoint that ended before the epoch ended. This can cause unreliable results if further training is done. Consider using an end-of-epoch checkpoint or enabling fault-tolerant training: https://pytorch-lightning.readthedocs.io/en/stable/advanced/fault_tolerant_training.html
  rank_zero_warn(
/zhome/56/e/155505/Desktop/DeepLearningProject/diffwave/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py:48: UserWarning: Detected KeyboardInterrupt, attempting graceful shutdown...
  rank_zero_warn("Detected KeyboardInterrupt, attempting graceful shutdown...")
